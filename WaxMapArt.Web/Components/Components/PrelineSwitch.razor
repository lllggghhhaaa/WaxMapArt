@inherits InputBase<bool>

<div class="flex items-center gap-3">
    <!-- Toggle Switch -->
    <button
        type="button"
        role="switch"
        aria-checked="@CurrentValue"
        aria-labelledby="@(string.IsNullOrEmpty(Label) ? null : $"label-{GetHashCode()}")"
        @onclick="ToggleValue"
        disabled="@Disabled"
        class="@GetToggleClasses()"
    >
        <span class="@GetThumbClasses()" style="@GetThumbStyle()"></span>
    </button>

    <!-- Label -->
    @if (!string.IsNullOrEmpty(Label))
    {
        <label 
            id="label-@GetHashCode()" 
            @onclick="ToggleValue"
            class="@GetLabelClasses()">
            @Label
        </label>
    }
</div>

@code {
    [Parameter] public string? Label { get; set; }
    [Parameter] public bool Disabled { get; set; }

    private void ToggleValue()
    {
        if (!Disabled)
        {
            CurrentValue = !CurrentValue;
        }
    }

    private string GetToggleClasses()
        => $"relative inline-flex items-center h-6 w-11 flex-shrink-0 rounded-full transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-neutral-900 {(Disabled ? "opacity-50 cursor-not-allowed" : "cursor-pointer")} {(CurrentValue ? "bg-blue-600 dark:bg-blue-500" : "bg-gray-200 dark:bg-neutral-700")}";

    private string GetThumbClasses()
        => "absolute top-0.5 h-5 w-5 rounded-full bg-white shadow-lg transition-all duration-200 ease-in-out";

    private string GetThumbStyle()
        => CurrentValue ? "left: calc(100% - 22px);" : "left: 2px;";

    private string GetLabelClasses()
        => $"text-sm font-medium text-gray-700 dark:text-neutral-300 select-none {(!Disabled ? "cursor-pointer" : "opacity-50 cursor-not-allowed")}";

    protected override bool TryParseValueFromString(string? value, out bool result, out string? validationErrorMessage)
    {
        result = bool.TryParse(value, out var parsed) && parsed;
        validationErrorMessage = null;
        return true;
    }

}